"polname","table_name","command","using_expression","with_check_expression","policy_type","roles"
"Everyone can view classes","classes","SELECT","true",NULL,"PERMISSIVE","['-']"
"Users can view all profiles","profiles","SELECT","true",NULL,"PERMISSIVE","['-']"
"Users can update their own profile","profiles","UPDATE","(auth.uid() = id)",NULL,"PERMISSIVE","['-']"
"Only admins can manage user roles","user_roles","ALL","has_role(auth.uid(), 'admin'::app_role)",NULL,"PERMISSIVE","['authenticated']"
"Voters can insert their own votes","votes","INSERT",NULL,"(voter_id = auth.uid())","PERMISSIVE","['-']"
"Everyone can view event voter groups","event_voter_groups","SELECT","true",NULL,"PERMISSIVE","['-']"
"Admins can create notifications","candidate_notifications","INSERT",NULL,"has_role(auth.uid(), 'admin'::app_role)","PERMISSIVE","['authenticated']"
"Users can update their own notifications","candidate_notifications","UPDATE","(user_id = auth.uid())",NULL,"PERMISSIVE","['authenticated']"
"Only admins can insert profiles","profiles","INSERT",NULL,"has_role(auth.uid(), 'admin'::app_role)","PERMISSIVE","['authenticated']"
"Only admins can delete profiles","profiles","DELETE","has_role(auth.uid(), 'admin'::app_role)",NULL,"PERMISSIVE","['authenticated']"
"Admins can insert candidates","candidates","INSERT",NULL,"has_role(auth.uid(), 'admin'::app_role)","PERMISSIVE","['authenticated']"
"Only admins can delete candidates","candidates","DELETE","has_role(auth.uid(), 'admin'::app_role)",NULL,"PERMISSIVE","['authenticated']"
"Only admins can manage classes","classes","ALL","has_role(auth.uid(), 'admin'::app_role)",NULL,"PERMISSIVE","['authenticated']"
"Everyone can view active and closed events","election_events","SELECT","((status = ANY (ARRAY['active'::text, 'closed'::text])) OR has_role(auth.uid(), 'admin'::app_role))",NULL,"PERMISSIVE","['authenticated']"
"Only admins can manage events","election_events","ALL","has_role(auth.uid(), 'admin'::app_role)",NULL,"PERMISSIVE","['authenticated']"
"Only admins can manage event voter groups","event_voter_groups","ALL","has_role(auth.uid(), 'admin'::app_role)",NULL,"PERMISSIVE","['authenticated']"
"Admins can view all votes","votes","SELECT","has_role(auth.uid(), 'admin'::app_role)",NULL,"PERMISSIVE","['authenticated']"
"Users can view their own roles","user_roles","SELECT","(user_id = auth.uid())",NULL,"PERMISSIVE","['authenticated']"
"Anyone can view candidate photos","storage.objects","SELECT","(bucket_id = 'candidate-photos'::text)",NULL,"PERMISSIVE","['-']"
"Authenticated users can upload candidate photos","storage.objects","INSERT",NULL,"((bucket_id = 'candidate-photos'::text) AND ((storage.foldername(name))[1] = (auth.uid())::text))","PERMISSIVE","['authenticated']"
"Users can update their own candidate photos","storage.objects","UPDATE","((bucket_id = 'candidate-photos'::text) AND ((storage.foldername(name))[1] = (auth.uid())::text))",NULL,"PERMISSIVE","['authenticated']"
"Users can delete their own candidate photos","storage.objects","DELETE","((bucket_id = 'candidate-photos'::text) AND ((storage.foldername(name))[1] = (auth.uid())::text))",NULL,"PERMISSIVE","['authenticated']"
"Candidates can update their own profile","candidates","UPDATE","(user_id = auth.uid())","(((user_id = auth.uid()) AND (vision IS NOT NULL)) OR (mission IS NOT NULL) OR (photo_storage_path IS NOT NULL))","PERMISSIVE","['authenticated']"
"Voters can view approved candidates","candidates","SELECT","((status = 'approved'::candidate_status) OR has_role(auth.uid(), 'admin'::app_role) OR (user_id = auth.uid()))",NULL,"PERMISSIVE","['authenticated']"
"Admins can approve or reject candidates","candidates","UPDATE","has_role(auth.uid(), 'admin'::app_role)","has_role(auth.uid(), 'admin'::app_role)","PERMISSIVE","['authenticated']"
"Users can view their own notifications","candidate_notifications","SELECT","(user_id = auth.uid())",NULL,"PERMISSIVE","['authenticated']"
